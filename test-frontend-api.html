// Test frontend API call directly
async function testFrontendAPICall() {
  const baseURL = 'http://localhost:5000';
  
  try {
    console.log('🧪 Testing frontend API call...');
    
    const response = await fetch(`${baseURL}/delivery/schedules`);
    const data = await response.json();
    
    console.log('📊 Raw response:', data);
    console.log('📊 Response structure:', {
      isArray: Array.isArray(data),
      hasSuccess: 'success' in data,
      hasSchedules: 'schedules' in data,
      dataKeys: Object.keys(data)
    });
    
    // Test the frontend logic
    const schedules = Array.isArray(data) ? data : data.schedules || [];
    console.log(`📋 Parsed schedules: ${schedules.length} items`);
    
    let deliveryCounts = {};
    const activeStatuses = ['pending', 'scheduled', 'in_transit', 'delayed'];
    
    schedules.forEach(schedule => {
      const status = schedule.delivery_status || schedule.status;
      console.log(`📦 Schedule ${schedule.id}: Courier ${schedule.courier_id}, Status: ${status}`);
      
      if (schedule.courier_id && status && activeStatuses.includes(status.toLowerCase())) {
        deliveryCounts[schedule.courier_id] = (deliveryCounts[schedule.courier_id] || 0) + 1;
        console.log(`  ✅ ACTIVE: Courier ${schedule.courier_id} - ${status}`);
      }
    });
    
    console.log('📊 Final counts:', deliveryCounts);
    console.log(`📦 Courier 4 active deliveries: ${deliveryCounts[4] || 0}`);
    
  } catch (error) {
    console.error('❌ Test failed:', error);
  }
}

// Run the test
testFrontendAPICall();
